<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finale Nanawax XV</title>

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

<!-- EmailJS -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
  --marron:#7a5c48;
  --beige:#d3b9a0;
  --glass:rgba(255,255,255,0.32);
  --border:rgba(255,255,255,0.45);
}

*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}

body{
  min-height:100vh;
  background:
    linear-gradient(
      rgba(122,92,72,0.55),
      rgba(211,185,160,0.45)
    ),
    url("Gemini_Generated_Image_rtbq4wrtbq4wrtbq.png") center/cover no-repeat fixed;
  color:#3f2b1f;
  padding:50px 20px;
}

body::before{
  content:"";
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle at top,
      rgba(255,255,255,0.25),
      transparent 60%);
  pointer-events:none;
}

.background-wave{
  position:fixed;
  inset:-20%;
  background:
    linear-gradient(
      120deg,
      rgba(122,92,72,0.35),
      rgba(211,185,160,0.35)
    );
  z-index:-2;
  filter:blur(60px);
}


/* ===== CONTAINER ===== */
.container{
  max-width:1000px;
  margin:auto;
}

/* ===== HERO ===== */
.hero{
  text-align:center;
  margin-bottom:60px;
}

.hero img{
  width:160px;
  margin-bottom:25px;
}

.hero h1{
  font-size:2.8rem;
  font-weight:300;
  letter-spacing:1px;
  line-height:1.2;
}

.hero .subtitle{
  margin-top:10px;
  font-size:1.3rem;
  color:var(--marron);
  font-weight:500;
  letter-spacing:0.5px;
}

.hero p{
  margin-top:15px;
  font-size:1.15rem;
  color:#4e3728;
}

/* ===== GLASS CARD ===== */
.glass{
  background:var(--glass);
  backdrop-filter:blur(5px);
  -webkit-backdrop-filter:blur(5px);
  border-radius:34px;
  border:1px solid var(--border);
  box-shadow:
    inset 0 0 20px rgba(255,255,255,0.2),
    0 20px 50px rgba(0,0,0,0.15);
  padding:55px;
}

/* ===== FORM ===== */
h2{
  text-align:center;
  font-weight:400;
  margin-bottom:40px;
}

.group{
  margin-bottom:28px;
}

label{
  display:block;
  margin-bottom:8px;
  font-weight:500;
}

input, select{
  width:100%;
  padding:16px 18px;
  border-radius:18px;
  border:none;
  background:rgba(255,255,255,0.85);
  font-size:1rem;
}

/* ===== OPTIONS ===== */
.options{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:16px;
  margin-top:10px;
}

.option{
  padding:18px;
  border-radius:20px;
  background:rgba(255,255,255,0.55);
  text-align:center;
  cursor:pointer;
  transition:.35s;
  font-weight:500;
}

.option.active{
  background:rgba(122,92,72,0.35);
  border:2px solid var(--marron);
}

/* ===== BUTTON ===== */
button{
  width:100%;
  padding:18px;
  border:none;
  border-radius:22px;
  background:
    linear-gradient(135deg,#7a5c48,#9b7a60);
  color:white;
  font-size:1.15rem;
  cursor:pointer;
  margin-top:20px;
  transition:transform 0.3s;
}

button:hover{
  transform:translateY(-2px);
}

/* ===== HIDDEN ===== */
.hidden{display:none}

/* ===== CONFIRM ===== */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.65);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:1000;
}

.overlay.show{display:flex}

.confirm{
  background:white;
  padding:45px;
  border-radius:30px;
  max-width:460px;
  width:90%;
  text-align:center;
}

.particles{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:-1;
}

.particle{
  position:absolute;
  width:6px;
  height:6px;
  border-radius:50%;
  background:rgba(255,215,160,0.55);
  box-shadow:0 0 12px rgba(255,215,160,0.6);
  opacity:0;
}

/* ===== GOUTTELETTES D'EAU ===== */
.water-droplets{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:1;
}

.droplet{
  position:absolute;
  border-radius:50%;
  background:rgba(255,255,255,0.18);
  box-shadow:
    inset -2px -2px 6px rgba(255,255,255,0.4),
    inset 2px 2px 6px rgba(255,255,255,0.08);
  backdrop-filter: blur(1px);
}

/* ===== RAYONS DE SOLEIL ===== */
.sun-rays{
  position:fixed;
  top:8%;
  right:10%;
  width:180px;
  height:180px;
  pointer-events:none;
  opacity:0.55;
}

.ray{
  position:absolute;
  width:4px;
  height:80px;
  background:linear-gradient(
    to bottom,
    rgba(255,255,210,0.85),
    rgba(255,200,120,0.25)
  );
  border-radius:3px;
  top:50%;
  left:50%;
  transform-origin:center 0;
}

/* Style pour le select d'indicatif */
#indicatif {
  border-radius: 18px;
  border: none;
  background: rgba(255,255,255,0.85);
  font-size: 1rem;
  cursor: pointer;
  appearance: none;
  -webkit-appearance: none;
  background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%237a5c48'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
  background-repeat: no-repeat;
  background-position: right 15px center;
  background-size: 16px;
  padding-right: 40px;
}

#indicatif option {
  padding: 10px;
}

/* ===== FORM SECTIONS ===== */
.form-section {
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 1px solid rgba(122,92,72,0.2);
}

.form-section h3 {
  font-size: 1.3rem;
  font-weight: 400;
  margin-bottom: 20px;
  color: var(--marron);
}

/* Alcool section */
.alcool-section {
  transition: all 0.3s ease;
}

/* Photo upload */
#photo {
  cursor: pointer;
  border-radius: 18px;
  border: 2px dashed rgba(122,92,72,0.3);
  padding: 16px;
  background: rgba(255,255,255,0.7);
  transition: all 0.3s;
}

#photo:hover {
  background: rgba(255,255,255,0.9);
  border-color: var(--marron);
}

#preview-image {
  max-height: 250px;
  object-fit: cover;
  border-radius: 15px;
  box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.instagram-input {
  display: flex;
  align-items: center;
  background: rgba(255,255,255,0.85);
  border-radius: 18px;
  padding-right: 18px;
}

.instagram-prefix {
  padding: 16px 0 16px 18px;
  font-size: 1rem;
  color: var(--marron);
  font-weight: 500;
}

/* Loading animation */
.loading {
  display: none;
  text-align: center;
  margin-top: 20px;
}

.spinner {
  width: 40px;
  height: 40px;
  border: 4px solid rgba(122,92,72,0.2);
  border-top: 4px solid var(--marron);
  border-radius: 50%;
  animation: spin 1s linear infinite;
  margin: 0 auto 10px;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}

/* ===== RESPONSIVE MOBILE ===== */
@media (max-width: 768px) {
  body {
    padding: 30px 15px;
  }
  
  .hero {
    margin-bottom: 40px;
  }
  
  .hero img {
    width: 120px;
    margin-bottom: 20px;
  }
  
  .hero h1 {
    font-size: 2.2rem;
    line-height: 1.3;
    padding: 0 10px;
  }
  
  .hero .subtitle {
    font-size: 1.1rem;
    margin-top: 5px;
  }
  
  .hero p {
    font-size: 1rem;
    line-height: 1.5;
    padding: 0 10px;
  }
  
  .glass {
    padding: 30px 25px;
    border-radius: 25px;
  }
  
  h2 {
    font-size: 1.8rem;
    margin-bottom: 30px;
  }
  
  .form-section h3 {
    font-size: 1.2rem;
    margin-bottom: 15px;
  }
  
  .options {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 12px;
  }
  
  .option {
    padding: 14px 10px;
    font-size: 0.95rem;
    border-radius: 16px;
  }
  
  input, select {
    padding: 14px 16px;
    font-size: 0.95rem;
  }
  
  #indicatif {
    flex: 0 0 120px !important;
    padding: 14px 10px !important;
    font-size: 0.9rem;
  }
  
  button {
    padding: 16px;
    font-size: 1.1rem;
    border-radius: 20px;
  }
  
  .confirm {
    padding: 30px 25px;
    border-radius: 25px;
  }
  
  .sun-rays {
    width: 120px;
    height: 120px;
    top: 5%;
    right: 5%;
    opacity: 0.4;
  }
  
  .ray {
    height: 50px;
    width: 3px;
  }
  
  .water-droplets {
    display: none;
  }
}

@media (max-width: 480px) {
  .hero h1 {
    font-size: 1.9rem;
  }
  
  .hero .subtitle {
    font-size: 1rem;
  }
  
  .glass {
    padding: 25px 20px;
    border-radius: 22px;
  }
  
  .options {
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 10px;
  }
  
  .option {
    padding: 12px 8px;
    font-size: 0.9rem;
  }
  
  #indicatif {
    flex: 0 0 100px !important;
    padding: 12px 8px !important;
  }
  
  .form-section h3 {
    font-size: 1.1rem;
  }
  
  .group {
    margin-bottom: 20px;
  }
  
  .form-section {
    margin-bottom: 25px;
    padding-bottom: 15px;
  }
  
  .instagram-prefix {
    padding: 14px 0 14px 14px;
    font-size: 0.95rem;
  }
}
</style>
</head>

<body>

<div class="background-wave"></div>

<div class="water-droplets" id="droplets"></div>

<div class="particles" id="particles"></div>

<div class="container">

  <!-- HERO -->
  <section class="hero">
    <img src="nanawax maron.png" alt="Nanawax">
    <h1>Finale Nanawax 15ans</h1>
    <div class="subtitle">Un dÃ®ner, une soirÃ©e, un brunch</div>
    <p>
      Assinie â€¢ CÃ´te d'Ivoire<br>
      28 â†’ 30 mars 2026
    </p>
  </section>

  <!-- FORM -->
  <section class="glass">
    <h2>RÃ©servation</h2>

    <form id="form">
      
      <!-- Loading animation -->
      <div class="loading" id="loading">
        <div class="spinner"></div>
        <p>Traitement en cours...</p>
      </div>

      <!-- NOM ET PRÃ‰NOM -->
      <div class="form-section">
        <h3>Informations personnelles</h3>
        <div class="group">
          <label>Nom *</label>
          <input id="nom" required>
        </div>
        <div class="group">
          <label>PrÃ©nom *</label>
          <input id="prenom" required>
        </div>
        
        <!-- TÃ©lÃ©phone avec indicatif -->
        <div class="group">
          <label>NumÃ©ro WhatsApp *</label>
          <div style="display: flex; gap: 12px;">
            <select id="indicatif" style="flex: 0 0 140px; padding: 16px 12px;">
              <option value="+225">ðŸ‡¨ðŸ‡® +225 (CÃ´te d'Ivoire)</option>
              <option value="+33">ðŸ‡«ðŸ‡· +33 (France)</option>
              <option value="+32">ðŸ‡§ðŸ‡ª +32 (Belgique)</option>
              <option value="+41">ðŸ‡¨ðŸ‡­ +41 (Suisse)</option>
              <option value="+1">ðŸ‡ºðŸ‡¸ +1 (Ã‰tats-Unis)</option>
              <option value="+44">ðŸ‡¬ðŸ‡§ +44 (Royaume-Uni)</option>
              <option value="+49">ðŸ‡©ðŸ‡ª +49 (Allemagne)</option>
              <option value="+34">ðŸ‡ªðŸ‡¸ +34 (Espagne)</option>
              <option value="+39">ðŸ‡®ðŸ‡¹ +39 (Italie)</option>
              <option value="+31">ðŸ‡³ðŸ‡± +31 (Pays-Bas)</option>
              <option value="+351">ðŸ‡µðŸ‡¹ +351 (Portugal)</option>
              <option value="+213">ðŸ‡©ðŸ‡¿ +213 (AlgÃ©rie)</option>
              <option value="+216">ðŸ‡¹ðŸ‡³ +216 (Tunisie)</option>
              <option value="+212">ðŸ‡²ðŸ‡¦ +212 (Maroc)</option>
              <option value="+221">ðŸ‡¸ðŸ‡³ +221 (SÃ©nÃ©gal)</option>
              <option value="+223">ðŸ‡²ðŸ‡± +223 (Mali)</option>
              <option value="+229">ðŸ‡§ðŸ‡¯ +229 (BÃ©nin)</option>
              <option value="+226">ðŸ‡§ðŸ‡« +226 (Burkina Faso)</option>
              <option value="+228">ðŸ‡¹ðŸ‡¬ +228 (Togo)</option>
              <option value="+237">ðŸ‡¨ðŸ‡² +237 (Cameroun)</option>
              <option value="+242">ðŸ‡¨ðŸ‡¬ +242 (Congo)</option>
              <option value="+243">ðŸ‡¨ðŸ‡© +243 (RDC)</option>
              <option value="+233">ðŸ‡¬ðŸ‡­ +233 (Ghana)</option>
              <option value="+234">ðŸ‡³ðŸ‡¬ +234 (Nigeria)</option>
              <option value="+250">ðŸ‡·ðŸ‡¼ +250 (Rwanda)</option>
              <option value="+254">ðŸ‡°ðŸ‡ª +254 (Kenya)</option>
              <option value="+255">ðŸ‡¹ðŸ‡¿ +255 (Tanzanie)</option>
              <option value="+27">ðŸ‡¿ðŸ‡¦ +27 (Afrique du Sud)</option>
              <option value="+90">ðŸ‡¹ðŸ‡· +90 (Turquie)</option>
              <option value="+971">ðŸ‡¦ðŸ‡ª +971 (Ã‰mirats)</option>
              <option value="+966">ðŸ‡¸ðŸ‡¦ +966 (Arabie Saoudite)</option>
              <option value="+20">ðŸ‡ªðŸ‡¬ +20 (Ã‰gypte)</option>
              <option value="+852">ðŸ‡­ðŸ‡° +852 (Hong Kong)</option>
              <option value="+86">ðŸ‡¨ðŸ‡³ +86 (Chine)</option>
              <option value="+81">ðŸ‡¯ðŸ‡µ +81 (Japon)</option>
              <option value="+82">ðŸ‡°ðŸ‡· +82 (CorÃ©e du Sud)</option>
              <option value="+65">ðŸ‡¸ðŸ‡¬ +65 (Singapour)</option>
              <option value="+60">ðŸ‡²ðŸ‡¾ +60 (Malaisie)</option>
              <option value="+61">ðŸ‡¦ðŸ‡º +61 (Australie)</option>
              <option value="+64">ðŸ‡³ðŸ‡¿ +64 (Nouvelle-ZÃ©lande)</option>
              <option value="+55">ðŸ‡§ðŸ‡· +55 (BrÃ©sil)</option>
              <option value="+52">ðŸ‡²ðŸ‡½ +52 (Mexique)</option>
              <option value="+51">ðŸ‡µðŸ‡ª +51 (PÃ©rou)</option>
              <option value="+57">ðŸ‡¨ðŸ‡´ +57 (Colombie)</option>
              <option value="+58">ðŸ‡»ðŸ‡ª +58 (Venezuela)</option>
              <option value="+54">ðŸ‡¦ðŸ‡· +54 (Argentine)</option>
              <option value="+56">ðŸ‡¨ðŸ‡± +56 (Chile)</option>
              <option value="+7">ðŸ‡·ðŸ‡º +7 (Russie)</option>
              <option value="+380">ðŸ‡ºðŸ‡¦ +380 (Ukraine)</option>
              <option value="+48">ðŸ‡µðŸ‡± +48 (Pologne)</option>
              <option value="+40">ðŸ‡·ðŸ‡´ +40 (Roumanie)</option>
              <option value="+30">ðŸ‡¬ðŸ‡· +30 (GrÃ¨ce)</option>
            </select>
            <input id="telephone" required placeholder="NumÃ©ro WhatsApp" style="flex: 1;">
          </div>
        </div>
        
        <div class="group">
          <label>Email *</label>
          <input id="email" type="email" required>
        </div>
      </div>

      <!-- INSTAGRAM -->
      <div class="form-section">
        <h3>Compte Instagram *</h3>
        <div class="group">
          <div class="instagram-input">
            <span class="instagram-prefix">@</span>
            <input id="instagram" required placeholder="nomdutilisateur" style="border: none; background: transparent; padding-left: 0;">
          </div>
        </div>
      </div>

      <!-- TAILLE DES VÃŠTEMENTS -->
      <div class="form-section">
        <h3>Taille des vÃªtements</h3>
        <div class="options" id="taille-vetements">
          <div class="option" data-value="XS">XS</div>
          <div class="option" data-value="S">S</div>
          <div class="option" data-value="M">M</div>
          <div class="option" data-value="L">L</div>
          <div class="option" data-value="XL">XL</div>
          <div class="option" data-value="2XL">2XL</div>
          <div class="option" data-value="3XL">3XL</div>
          <div class="option" data-value="4XL">4XL</div>
        </div>
      </div>

      <!-- PHOTO -->
      <div class="form-section">
        <h3>Photo de vous habillÃ© en Nanawax (optionnel)</h3>
        <div class="group">
          <input type="file" id="photo" accept="image/*">
          <small style="display: block; margin-top: 8px; color: #666; font-size: 0.9rem;">
            Format recommandÃ© : JPG, PNG (max 5MB)
          </small>
        </div>
        <div id="photo-preview" style="margin-top: 20px; display: none; text-align: center;">
          <img id="preview-image" src="" alt="AperÃ§u de la photo">
        </div>
      </div>

      <!-- POINTURES -->
      <div class="form-section">
        <h3>Pointure</h3>
        <div class="options" id="pointures">
          <div class="option" data-value="36">36</div>
          <div class="option" data-value="37">37</div>
          <div class="option" data-value="38">38</div>
          <div class="option" data-value="39">39</div>
          <div class="option" data-value="40">40</div>
          <div class="option" data-value="41">41</div>
          <div class="option" data-value="42">42</div>
          <div class="option" data-value="43">43</div>
          <div class="option" data-value="44">44</div>
          <div class="option" data-value="45">45</div>
          <div class="option" data-value="46">46</div>
        </div>
      </div>

      <!-- COULEURS PRÃ‰FÃ‰RÃ‰ES -->
      <div class="form-section">
        <h3>Couleurs prÃ©fÃ©rÃ©es</h3>
        <div class="options" id="couleurs">
          <div class="option" data-value="blanc">blanc</div>
          <div class="option" data-value="noir">noir</div>
          <div class="option" data-value="marron">marron</div>
          <div class="option" data-value="beige">beige</div>
          <div class="option" data-value="bleu">bleu</div>
          <div class="option" data-value="vert">vert</div>
          <div class="option" data-value="rouge">rouge</div>
          <div class="option" data-value="rose">rose</div>
          <div class="option" data-value="violet">violet</div>
          <div class="option" data-value="jaune">jaune</div>
          <div class="option" data-value="orange">orange</div>
          <div class="option" data-value="saumon">saumon</div>
          <div class="option" data-value="terracotta">terracotta</div>
        </div>
      </div>

      <!-- ODEURS PRÃ‰FÃ‰RÃ‰ES -->
      <div class="form-section">
        <h3>Odeur prÃ©fÃ©rÃ©e</h3>
        <div class="options" id="odeurs">
          <div class="option" data-value="vanille">Vanille</div>
          <div class="option" data-value="lavande">Lavande</div>
          <div class="option" data-value="oud">Oud</div>
          <div class="option" data-value="jasmin">Jasmin</div>
          <div class="option" data-value="fruit de la passion">Fruit de la passion</div>
          <div class="option" data-value="menthe">Menthe</div>
          <div class="option" data-value="aucun">Aucun</div>
        </div>
      </div>

      <!-- CONSOMMATION D'ALCOOL -->
      <div class="form-section">
        <h3>Consommation d'alcool</h3>
        <div class="options" id="alcool-option">
          <div class="option" data-value="oui">Oui</div>
          <div class="option" data-value="non">Non</div>
        </div>
      </div>

      <!-- JUS PRÃ‰FÃ‰RÃ‰S -->
      <div class="form-section" id="jus-section">
        <h3>Jus prÃ©fÃ©rÃ©s</h3>
        <div class="options" id="jus">
          <div class="option" data-value="pomme">pomme</div>
          <div class="option" data-value="mangue">mangue</div>
          <div class="option" data-value="ananas">ananas</div>
          <div class="option" data-value="orange">orange</div>
          <div class="option" data-value="aucun">aucun</div>
        </div>
      </div>

      <!-- CHAMPAGNE (UNIQUEMENT SI ALCOOL = OUI) -->
      <div class="form-section alcool-section hidden" id="champagne-section">
        <h3>Champagne prÃ©fÃ©rÃ©</h3>
        <div class="options" id="champagne">
          <div class="option" data-value="rosÃ©">rosÃ©</div>
          <div class="option" data-value="demi sec">demi sec</div>
          <div class="option" data-value="brut">brut</div>
        </div>
      </div>

      <!-- SPIRITUEUX (UNIQUEMENT SI ALCOOL = OUI) -->
      <div class="form-section alcool-section hidden" id="spiritueux-section">
        <h3>Spiritueux prÃ©fÃ©rÃ©s</h3>
        <div class="options" id="spiritueux">
          <div class="option" data-value="vodka">vodka</div>
          <div class="option" data-value="rhum">rhum</div>
          <div class="option" data-value="gin">gin</div>
          <div class="option" data-value="whisky">whisky</div>
        </div>
      </div>

      <!-- BOISSONS CHAUDES -->
      <div class="form-section">
        <h3>Boissons chaudes</h3>
        <div class="options" id="boissons-chaudes">
          <div class="option" data-value="thÃ©">ThÃ©</div>
          <div class="option" data-value="cafÃ©">CafÃ©</div>
        </div>
      </div>

      <!-- ALLERGIES FRUITS DE MER -->
      <div class="form-section">
        <h3>Allergies aux fruits de mer</h3>
        <div class="options" id="allergies">
          <div class="option" data-value="oui">Oui</div>
          <div class="option" data-value="non">Non</div>
        </div>
      </div>

      <button type="submit" id="submit-btn">Confirmer la rÃ©servation</button>

    </form>
  </section>
</div>

<!-- CONFIRMATION -->
<div class="overlay" id="overlay">
  <div class="confirm">
    <h2>ðŸŽ‰ RÃ©servation confirmÃ©e</h2>
    <div id="resume"></div><br>
    <button onclick="closeConfirm()">Fermer</button>
  </div>
</div>

<script>
  // Configuration Cloudinary
  const CLOUDINARY_CLOUD_NAME = 'dehjhn0we';
  const CLOUDINARY_UPLOAD_PRESET = 'nanawax_photos';

  // Configuration EmailJS - VOTRE USER ID
  emailjs.init("13uhnx4ywp64w0KDy");

  /* ===== GOUTTELETTES D'EAU ===== */
  const dropletsContainer = document.getElementById("droplets");
  const DROPLETS_COUNT = 22;

  for(let i=0;i<DROPLETS_COUNT;i++){
    const d = document.createElement("div");
    d.className = "droplet";
    dropletsContainer.appendChild(d);

    const size = Math.random() * 24 + 8;

    gsap.set(d,{
      width: size,
      height: size,
      x: Math.random() * window.innerWidth,
      y: Math.random() * window.innerHeight,
      opacity: Math.random() * 0.25 + 0.15
    });

    gsap.to(d,{
      x: "+=" + (Math.random()*20-10),
      y: "+=" + (Math.random()*20-10),
      scale: Math.random()*0.15 + 0.95,
      duration: Math.random()*6 + 6,
      repeat:-1,
      yoyo:true,
      ease:"sine.inOut"
    });
  }

  /* ===== LOGIQUE ===== */
  const form = document.getElementById("form");
  const nom = document.getElementById("nom");
  const prenom = document.getElementById("prenom");
  const email = document.getElementById("email");
  const indicatif = document.getElementById("indicatif");
  const telephone = document.getElementById("telephone");
  const instagram = document.getElementById("instagram");
  const overlay = document.getElementById("overlay");
  const resume = document.getElementById("resume");
  const loading = document.getElementById("loading");
  const submitBtn = document.getElementById("submit-btn");

  // Sections alcool
  const champagneSection = document.getElementById("champagne-section");
  const spiritueuxSection = document.getElementById("spiritueux-section");

  // Variables pour stocker les sÃ©lections
  let selectedTaille = [];
  let selectedPointure = [];
  let selectedCouleurs = [];
  let selectedOdeurs = [];
  let selectedAlcool = "";
  let selectedJus = [];
  let selectedChampagne = [];
  let selectedSpiritueux = [];
  let selectedBoissonsChaudes = [];
  let selectedAllergies = "";

  /* ===== PARTICULES ===== */
  const particlesContainer = document.getElementById("particles");
  const PARTICLES_COUNT = 18;

  for(let i=0;i<PARTICLES_COUNT;i++){
    const p = document.createElement("div");
    p.className = "particle";
    particlesContainer.appendChild(p);

    gsap.set(p,{
      x: Math.random() * window.innerWidth,
      y: Math.random() * window.innerHeight,
      scale: Math.random() * 1.2 + 0.4
    });

    gsap.to(p,{
      y: "-=120",
      x: "+=40",
      opacity: 1,
      duration: Math.random() * 10 + 12,
      repeat: -1,
      yoyo: true,
      ease: "sine.inOut",
      delay: Math.random() * 5
    });
  }

  /* ===== GESTION DES OPTIONS ===== */
  function setupOptions(containerId, selectedArray, isSingle = false) {
    const container = document.getElementById(containerId);
    const options = container.querySelectorAll(".option");
    
    options.forEach(option => {
      option.onclick = () => {
        if (isSingle) {
          // Pour une sÃ©lection unique
          options.forEach(o => o.classList.remove("active"));
          option.classList.add("active");
          selectedArray.length = 0;
          selectedArray.push(option.dataset.value);
        } else {
          // Pour sÃ©lection multiple
          option.classList.toggle("active");
          const value = option.dataset.value;
          if (selectedArray.includes(value)) {
            const index = selectedArray.indexOf(value);
            selectedArray.splice(index, 1);
          } else {
            selectedArray.push(value);
          }
        }
      };
    });
    
    return { options, selectedArray };
  }

  // Initialiser toutes les options
  const tailleVetements = setupOptions("taille-vetements", selectedTaille, true);
  selectedTaille = tailleVetements.selectedArray;

  const pointures = setupOptions("pointures", selectedPointure, true);
  selectedPointure = pointures.selectedArray;

  const couleurs = setupOptions("couleurs", selectedCouleurs);
  selectedCouleurs = couleurs.selectedArray;

  const odeurs = setupOptions("odeurs", selectedOdeurs, true);
  selectedOdeurs = odeurs.selectedArray;

  // Configuration alcool
  document.querySelectorAll('#alcool-option .option').forEach(option => {
    option.onclick = function() {
      document.querySelectorAll('#alcool-option .option').forEach(o => o.classList.remove("active"));
      this.classList.add("active");
      selectedAlcool = this.dataset.value;
      
      // Afficher/masquer les sections alcool
      if (selectedAlcool === "oui") {
        champagneSection.classList.remove("hidden");
        spiritueuxSection.classList.remove("hidden");
      } else {
        champagneSection.classList.add("hidden");
        spiritueuxSection.classList.add("hidden");
        // RÃ©initialiser les sÃ©lections d'alcool
        selectedChampagne = [];
        selectedSpiritueux = [];
        document.querySelectorAll('#champagne .option, #spiritueux .option').forEach(o => {
          o.classList.remove("active");
        });
      }
    };
  });

  const jus = setupOptions("jus", selectedJus);
  selectedJus = jus.selectedArray;

  const champagne = setupOptions("champagne", selectedChampagne);
  selectedChampagne = champagne.selectedArray;

  const spiritueux = setupOptions("spiritueux", selectedSpiritueux);
  selectedSpiritueux = spiritueux.selectedArray;

  const boissonsChaudes = setupOptions("boissons-chaudes", selectedBoissonsChaudes);
  selectedBoissonsChaudes = boissonsChaudes.selectedArray;

  // Configuration allergies
  document.querySelectorAll('#allergies .option').forEach(option => {
    option.onclick = function() {
      document.querySelectorAll('#allergies .option').forEach(o => o.classList.remove("active"));
      this.classList.add("active");
      selectedAllergies = this.dataset.value;
    };
  });

  /* ===== PRÃ‰VISUALISATION PHOTO ===== */
  document.getElementById('photo').addEventListener('change', function(e) {
    const preview = document.getElementById('photo-preview');
    const previewImage = document.getElementById('preview-image');
    
    if (this.files && this.files[0]) {
      const reader = new FileReader();
      
      reader.onload = function(e) {
        previewImage.src = e.target.result;
        preview.style.display = 'block';
      }
      
      reader.readAsDataURL(this.files[0]);
    } else {
      preview.style.display = 'none';
    }
  });

  /* ===== FONCTION D'ENVOI D'EMAILS ===== */
  async function sendEmails(data) {
    try {
      // 1. Envoyer l'email au propriÃ©taire (vous)
      const ownerTemplateData = {
        nom: data.nom,
        prenom: data.prenom,
        email: data.email,
        telephone_complet: data.telephone_complet,
        instagram: data.instagram,
        taille: data.taille,
        pointure: data.pointure,
        couleurs: data.couleurs,
        odeur: data.odeur,
        alcool: data.alcool,
        jus: data.jus,
        champagne: data.champagne,
        spiritueux: data.spiritueux,
        boissons_chaudes: data.boissons_chaudes,
        allergies_fruits_de_mer: data.allergies_fruits_de_mer,
        photo_url: data.photo_url,
        evenement: data.evenement,
        date: data.date,
        lieu: data.lieu,
        timestamp: new Date().toLocaleString('fr-FR')
      };

      const ownerResponse = await emailjs.send(
        "service_xoza1k6", // Votre Service ID
        "template_jtmxw1q", // Template pour VOUS recevoir les infos
        ownerTemplateData
      );

      console.log("Email propriÃ©taire envoyÃ©:", ownerResponse.status);

      // 2. Envoyer l'email de confirmation Ã  l'invitÃ©
      const guestTemplateData = {
        to_name: `${data.prenom} ${data.nom}`,
        to_email: data.email,
        evenement: data.evenement,
        date: data.date,
        lieu: data.lieu
      };

      const guestResponse = await emailjs.send(
        "service_xoza1k6", // MÃªme Service ID
        "template_s06wn2h", // Template pour les INVITÃ‰S (confirmation)
        guestTemplateData
      );

      console.log("Email invitÃ© envoyÃ©:", guestResponse.status);
      
      return { success: true, owner: ownerResponse, guest: guestResponse };
      
    } catch (error) {
      console.error("Erreur envoi emails:", error);
      return { success: false, error: error };
    }
  }

  /* ===== SOUMISSION DU FORMULAIRE ===== */
  form.onsubmit = async e => {
    e.preventDefault();

    // DÃ©sactiver le bouton pendant le traitement
    submitBtn.disabled = true;
    submitBtn.innerHTML = 'Traitement en cours...';
    loading.style.display = 'block';

    // VÃ©rifier que tous les champs obligatoires sont remplis
    const requiredFields = ['nom', 'prenom', 'email', 'telephone', 'instagram'];
    let isValid = true;
    let errorMessages = [];
    
    requiredFields.forEach(field => {
      const element = document.getElementById(field);
      if (!element.value.trim()) {
        isValid = false;
        element.style.border = '2px solid red';
        errorMessages.push(`Le champ ${field} est obligatoire`);
      } else {
        element.style.border = 'none';
      }
    });

    // VÃ©rifier les sÃ©lections obligatoires
    const requiredSelections = [
      { name: 'Taille', selected: selectedTaille.length },
      { name: 'Pointure', selected: selectedPointure.length },
      { name: 'Odeur prÃ©fÃ©rÃ©e', selected: selectedOdeurs.length },
      { name: 'Consommation alcool', selected: selectedAlcool },
      { name: 'Allergies fruits de mer', selected: selectedAllergies }
    ];

    requiredSelections.forEach(selection => {
      if (!selection.selected) {
        isValid = false;
        errorMessages.push(`Veuillez sÃ©lectionner une option pour "${selection.name}"`);
      }
    });

    if (!isValid) {
      alert('Veuillez corriger les erreurs suivantes :\n\n' + errorMessages.join('\n'));
      submitBtn.disabled = false;
      submitBtn.innerHTML = 'Confirmer la rÃ©servation';
      loading.style.display = 'none';
      return;
    }

    // RÃ©cupÃ©rer toutes les sÃ©lections actuelles
    selectedTaille = [];
    selectedPointure = [];
    selectedCouleurs = [];
    selectedOdeurs = [];
    selectedJus = [];
    selectedChampagne = [];
    selectedSpiritueux = [];
    selectedBoissonsChaudes = [];
    
    document.querySelectorAll('#taille-vetements .option.active').forEach(o => {
      selectedTaille.push(o.dataset.value);
    });
    
    document.querySelectorAll('#pointures .option.active').forEach(o => {
      selectedPointure.push(o.dataset.value);
    });
    
    document.querySelectorAll('#couleurs .option.active').forEach(o => {
      selectedCouleurs.push(o.dataset.value);
    });
    
    document.querySelectorAll('#odeurs .option.active').forEach(o => {
      selectedOdeurs.push(o.dataset.value);
    });
    
    document.querySelectorAll('#jus .option.active').forEach(o => {
      selectedJus.push(o.dataset.value);
    });
    
    document.querySelectorAll('#champagne .option.active').forEach(o => {
      selectedChampagne.push(o.dataset.value);
    });
    
    document.querySelectorAll('#spiritueux .option.active').forEach(o => {
      selectedSpiritueux.push(o.dataset.value);
    });
    
    document.querySelectorAll('#boissons-chaudes .option.active').forEach(o => {
      selectedBoissonsChaudes.push(o.dataset.value);
    });

    // Upload photo sur Cloudinary si elle existe
    let photoUrl = "";
    const photoInput = document.getElementById('photo');
    if (photoInput.files.length > 0) {
      try {
        const formData = new FormData();
        formData.append('file', photoInput.files[0]);
        formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
        
        const response = await fetch(
          `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`,
          {
            method: 'POST',
            body: formData
          }
        );
        
        const result = await response.json();
        photoUrl = result.secure_url;
      } catch (error) {
        console.error("Erreur d'upload :", error);
      }
    }

    const data = {
      nom: nom.value,
      prenom: prenom.value,
      email: email.value,
      indicatif: indicatif.value,
      telephone: telephone.value,
      telephone_complet: indicatif.value + " " + telephone.value,
      instagram: "@" + instagram.value,
      taille: selectedTaille.join(", ") || "â€”",
      pointure: selectedPointure.join(", ") || "â€”",
      couleurs: selectedCouleurs.join(", ") || "â€”",
      odeur: selectedOdeurs.join(", ") || "â€”",
      alcool: selectedAlcool || "â€”",
      jus: selectedJus.join(", ") || "â€”",
      champagne: selectedChampagne.join(", ") || "â€”",
      spiritueux: selectedSpiritueux.join(", ") || "â€”",
      boissons_chaudes: selectedBoissonsChaudes.join(", ") || "â€”",
      allergies_fruits_de_mer: selectedAllergies || "â€”",
      photo_url: photoUrl || "Aucune photo",
      evenement: "Finale Nanawax XV",
      date: "28-30 mars 2026",
      lieu: "Assinie"
    };

    // Envoyer les emails
    const emailResult = await sendEmails(data);

    // Afficher le rÃ©sultat
    loading.style.display = 'none';
    
    if (emailResult.success) {
      // Afficher le rÃ©sumÃ©
      resume.innerHTML = `
        <p><b>Nom :</b> ${data.nom} ${data.prenom}</p>
        <p><b>Email :</b> ${data.email}</p>
        <p><b>TÃ©lÃ©phone :</b> ${data.telephone_complet}</p>
        <p><b>Instagram :</b> ${data.instagram}</p>
        <p><b>Taille :</b> ${data.taille}</p>
        <p><b>Pointure :</b> ${data.pointure}</p>
        <p><b>Couleurs prÃ©fÃ©rÃ©es :</b> ${data.couleurs}</p>
        <p><b>Odeur prÃ©fÃ©rÃ©e :</b> ${data.odeur}</p>
        <p><b>Consommation d'alcool :</b> ${data.alcool}</p>
        <p><b>Jus prÃ©fÃ©rÃ©s :</b> ${data.jus}</p>
        ${data.alcool === "oui" ? `<p><b>Champagne :</b> ${data.champagne}</p>` : ''}
        ${data.alcool === "oui" ? `<p><b>Spiritueux :</b> ${data.spiritueux}</p>` : ''}
        <p><b>Boissons chaudes :</b> ${data.boissons_chaudes}</p>
        <p><b>Allergies fruits de mer :</b> ${data.allergies_fruits_de_mer}</p>
        <p><b>Photo :</b> ${data.photo_url === "Aucune photo" ? "Non fournie" : "âœ“ TÃ©lÃ©chargÃ©e"}</p>
        <hr style="margin: 20px 0;">
        <p style="color: #4CAF50; font-weight: 500;">âœ… RÃ©servation confirmÃ©e !</p>
        <p><i>Un email de confirmation a Ã©tÃ© envoyÃ© Ã  ${data.email}</i></p>
      `;
      
      overlay.classList.add("show");
    } else {
      alert("Une erreur s'est produite lors de l'envoi des emails. Veuillez rÃ©essayer.");
      submitBtn.disabled = false;
      submitBtn.innerHTML = 'Confirmer la rÃ©servation';
    }
  };

  function closeConfirm() {
    overlay.classList.remove("show");
    form.reset();
    
    // RÃ©initialiser toutes les sÃ©lections
    selectedTaille = [];
    selectedPointure = [];
    selectedCouleurs = [];
    selectedOdeurs = [];
    selectedAlcool = "";
    selectedJus = [];
    selectedChampagne = [];
    selectedSpiritueux = [];
    selectedBoissonsChaudes = [];
    selectedAllergies = "";
    
    // DÃ©sactiver toutes les options
    document.querySelectorAll('.option').forEach(o => {
      o.classList.remove("active");
    });
    
    // Masquer les sections alcool
    champagneSection.classList.add("hidden");
    spiritueuxSection.classList.add("hidden");
    
    // RÃ©initialiser la photo
    document.getElementById('photo').value = '';
    document.getElementById('photo-preview').style.display = 'none';
    
    // RÃ©initialiser les bordures
    document.querySelectorAll('input').forEach(input => {
      input.style.border = 'none';
    });
    
    // RÃ©activer le bouton
    submitBtn.disabled = false;
    submitBtn.innerHTML = 'Confirmer la rÃ©servation';
  }

  /* ===== ANIMATIONS GSAP ===== */
  gsap.from(".hero", { opacity: 0, y: -50, duration: 1 });
  gsap.from(".glass", { opacity: 0, y: 80, duration: 1, delay: .3 });
</script>

</body>
</html>