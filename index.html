<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Finale Nanawax XV</title>

<!-- GSAP -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

<!-- EmailJS -->
<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>

<!-- Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
  --marron:#7a5c48;
  --beige:#d3b9a0;
  --glass:rgba(255,255,255,0.32);
  --border:rgba(255,255,255,0.45);
}

*{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif}

body{
  min-height:100vh;
  background:
    linear-gradient(
      rgba(122,92,72,0.55),
      rgba(211,185,160,0.45)
    ),
    url("Gemini_Generated_Image_rtbq4wrtbq4wrtbq.png") center/cover no-repeat fixed;
  color:#3f2b1f;
  padding:50px 20px;
}

body::before{
  content:"";
  position:fixed;
  inset:0;
  background:
    radial-gradient(circle at top,
      rgba(255,255,255,0.25),
      transparent 60%);
  pointer-events:none;
}

.background-wave{
  position:fixed;
  inset:-20%;
  background:
    linear-gradient(
      120deg,
      rgba(122,92,72,0.35),
      rgba(211,185,160,0.35)
    );
  z-index:-2;
  filter:blur(60px);
}


/* ===== CONTAINER ===== */
.container{
  max-width:1000px;
  margin:auto;
}

/* ===== HERO ===== */
.hero{
  text-align:center;
  margin-bottom:60px;
}

.hero img{
  width:160px;
  margin-bottom:25px;
}

.hero h1{
  font-size:2.8rem; /* RÃ©duit pour tenir sur une ligne */
  font-weight:300;
  letter-spacing:1px;
  line-height:1.2;
}

.hero p{
  margin-top:15px;
  font-size:1.15rem;
  color:#4e3728;
}

/* ===== GLASS CARD ===== */
.glass{
  background:var(--glass);
  backdrop-filter:blur(5px); /* RÃ©duit de 26px Ã  5px seulement */
  -webkit-backdrop-filter:blur(5px);
  border-radius:34px;
  border:1px solid var(--border);
  box-shadow:
    inset 0 0 20px rgba(255,255,255,0.2), /* RÃ©duit l'effet interne */
    0 20px 50px rgba(0,0,0,0.15); /* Ombre plus lÃ©gÃ¨re */
  padding:55px;
}

/* ===== FORM ===== */
h2{
  text-align:center;
  font-weight:400;
  margin-bottom:40px;
}

.group{
  margin-bottom:28px;
}

label{
  display:block;
  margin-bottom:8px;
  font-weight:500;
}

input, select{
  width:100%;
  padding:16px 18px;
  border-radius:18px;
  border:none;
  background:rgba(255,255,255,0.85);
  font-size:1rem;
}

/* ===== OPTIONS ===== */
.options{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(160px,1fr));
  gap:16px;
  margin-top:10px;
}

.option{
  padding:18px;
  border-radius:20px;
  background:rgba(255,255,255,0.55);
  text-align:center;
  cursor:pointer;
  transition:.35s;
  font-weight:500;
}

.option.active{
  background:rgba(122,92,72,0.35);
  border:2px solid var(--marron);
}

/* ===== BUTTON ===== */
button{
  width:100%;
  padding:18px;
  border:none;
  border-radius:22px;
  background:
    linear-gradient(135deg,#7a5c48,#9b7a60);
  color:white;
  font-size:1.15rem;
  cursor:pointer;
  margin-top:20px;
}

/* ===== HIDDEN ===== */
.hidden{display:none}

/* ===== CONFIRM ===== */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,0.65);
  display:none;
  align-items:center;
  justify-content:center;
}

.overlay.show{display:flex}

.confirm{
  background:white;
  padding:45px;
  border-radius:30px;
  max-width:460px;
  width:90%;
  text-align:center;
}

.particles{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:-1;
}

.particle{
  position:absolute;
  width:6px;
  height:6px;
  border-radius:50%;
  background:rgba(255,215,160,0.55);
  box-shadow:0 0 12px rgba(255,215,160,0.6);
  opacity:0;
}

/* ===== GOUTTELETTES D'EAU (NON RUISSSELANTES) ===== */
.water-droplets{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:1;
}

.droplet{
  position:absolute;
  border-radius:50%;
  background:rgba(255,255,255,0.18);
  box-shadow:
    inset -2px -2px 6px rgba(255,255,255,0.4),
    inset 2px 2px 6px rgba(255,255,255,0.08);
  backdrop-filter: blur(1px);
}

/* ===== RAYONS DE SOLEIL ===== */
.sun-rays{
  position:fixed;
  top:8%;
  right:10%;
  width:180px;
  height:180px;
  pointer-events:none;
  opacity:0.55;
}

.ray{
  position:absolute;
  width:4px;
  height:80px;
  background:linear-gradient(
    to bottom,
    rgba(255,255,210,0.85),
    rgba(255,200,120,0.25)
  );
  border-radius:3px;
  top:50%;
  left:50%;
  transform-origin:center 0;
}

/* Style pour le select d'indicatif */
#indicatif {
  border-radius: 18px;
  border: none;
  background: rgba(255,255,255,0.85);
  font-size: 1rem;
  cursor: pointer;
  appearance: none;
  -webkit-appearance: none;
  background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%237a5c48'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
  background-repeat: no-repeat;
  background-position: right 15px center;
  background-size: 16px;
  padding-right: 40px;
}

#indicatif option {
  padding: 10px;
}

/* ===== FORM SECTIONS ===== */
.form-section {
  margin-bottom: 30px;
  padding-bottom: 20px;
  border-bottom: 1px solid rgba(122,92,72,0.2);
}

.form-section h3 {
  font-size: 1.3rem;
  font-weight: 400;
  margin-bottom: 20px;
  color: var(--marron);
}

/* Alcool section */
.alcool-section {
  transition: all 0.3s ease;
}

/* ===== UPLOAD PHOTO STYLES ===== */
.upload-container {
  background: rgba(255, 255, 255, 0.6);
  padding: 20px;
  border-radius: 18px;
  border: 1px dashed var(--marron);
}

#uploadBtn {
  border-radius: 16px;
  font-size: 1rem;
  padding: 12px 24px;
  background: linear-gradient(135deg, #9b7a60, #7a5c48);
  color: white;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  width: auto;
}

#uploadBtn:hover {
  transform: translateY(-2px);
  box-shadow: 0 5px 15px rgba(122, 92, 72, 0.3);
}

#uploadBtn:disabled {
  opacity: 0.7;
  cursor: not-allowed;
}

#removePhoto {
  border-radius: 12px;
  background: #e74c3c;
  color: white;
  border: none;
  cursor: pointer;
  transition: all 0.3s ease;
  padding: 6px 12px;
  font-size: 0.9rem;
  width: auto;
  margin-top: 8px;
}

#removePhoto:hover {
  background: #c0392b;
}

/* ===== RESPONSIVE MOBILE ===== */
@media (max-width: 768px) {
  body {
    padding: 30px 15px;
  }
  
  .hero {
    margin-bottom: 40px;
  }
  
  .hero img {
    width: 120px;
    margin-bottom: 20px;
  }
  
  .hero h1 {
    font-size: 2.2rem; /* Taille adaptÃ©e pour mobile */
    line-height: 1.3;
    padding: 0 10px;
  }
  
  .hero p {
    font-size: 1rem;
    line-height: 1.5;
    padding: 0 10px;
  }
  
  .glass {
    padding: 30px 25px;
    border-radius: 25px;
  }
  
  h2 {
    font-size: 1.8rem;
    margin-bottom: 30px;
  }
  
  .form-section h3 {
    font-size: 1.2rem;
    margin-bottom: 15px;
  }
  
  .options {
    grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
    gap: 12px;
  }
  
  .option {
    padding: 14px 10px;
    font-size: 0.95rem;
    border-radius: 16px;
  }
  
  input, select {
    padding: 14px 16px;
    font-size: 0.95rem;
  }
  
  /* TÃ©lÃ©phone mobile */
  #indicatif {
    flex: 0 0 120px !important;
    padding: 14px 10px !important;
    font-size: 0.9rem;
  }
  
  /* Bouton de soumission */
  button {
    padding: 16px;
    font-size: 1.1rem;
    border-radius: 20px;
  }
  
  /* Popup de confirmation */
  .confirm {
    padding: 30px 25px;
    border-radius: 25px;
  }
  
  /* Rayons de soleil plus petits sur mobile */
  .sun-rays {
    width: 120px;
    height: 120px;
    top: 5%;
    right: 5%;
    opacity: 0.4;
  }
  
  .ray {
    height: 50px;
    width: 3px;
  }
  
  /* Gouttelettes moins nombreuses sur mobile */
  .water-droplets {
    display: none; /* Optionnel : cachÃ© sur mobile pour performance */
  }
  
  /* Upload photo responsive */
  .upload-container {
    padding: 15px;
  }
  
  #uploadBtn {
    padding: 10px 16px;
    font-size: 0.95rem;
  }
  
  #imagePreview img {
    width: 120px;
    height: 120px;
  }
}

@media (max-width: 480px) {
  .hero h1 {
    font-size: 1.9rem;
  }
  
  .glass {
    padding: 25px 20px;
    border-radius: 22px;
  }
  
  .options {
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: 10px;
  }
  
  .option {
    padding: 12px 8px;
    font-size: 0.9rem;
  }
  
  #indicatif {
    flex: 0 0 100px !important;
    padding: 12px 8px !important;
  }
  
  /* Titres sections plus petits */
  .form-section h3 {
    font-size: 1.1rem;
  }
  
  /* RÃ©duire les marges */
  .group {
    margin-bottom: 20px;
  }
  
  .form-section {
    margin-bottom: 25px;
    padding-bottom: 15px;
  }
  
  /* Upload photo mobile */
  #uploadBtn {
    padding: 8px 14px;
    font-size: 0.9rem;
  }
  
  #fileName {
    font-size: 0.9rem;
    display: block;
    margin-top: 8px;
  }
  
  .upload-container {
    padding: 12px;
  }
}
</style>
</head>

<body>

<div class="background-wave"></div>

<div class="water-droplets" id="droplets"></div>

<div class="particles" id="particles"></div>

<div class="container">

  <!-- HERO -->
  <section class="hero">
    <img src="nanawax maron.png" alt="Nanawax">
    <h1>Finale Nanawax 15ans</h1>
    <p>
      Assinie â€¢ CÃ´te d'Ivoire<br>
      28 â†’ 30 mars 2026
    </p>
  </section>

  <!-- FORM -->
  <section class="glass">
    <h2>RÃ©servation</h2>

    <form id="form">

      <!-- NOM ET PRÃ‰NOM -->
      <div class="form-section">
        <h3>Informations personnelles</h3>
        <div class="group">
          <label>Nom *</label>
          <input id="nom" required>
        </div>
        <div class="group">
          <label>PrÃ©nom *</label>
          <input id="prenom" required>
        </div>
        
        <!-- TÃ©lÃ©phone avec indicatif -->
        <div class="group">
          <label>NumÃ©ro WhatsApp *</label>
          <div style="display: flex; gap: 12px;">
            <select id="indicatif" style="flex: 0 0 140px; padding: 16px 12px;">
              <!-- Options des indicatifs -->
              <option value="+225">ðŸ‡¨ðŸ‡® +225 (CÃ´te d'Ivoire)</option>
              <option value="+33">ðŸ‡«ðŸ‡· +33 (France)</option>
              <option value="+32">ðŸ‡§ðŸ‡ª +32 (Belgique)</option>
              <option value="+41">ðŸ‡¨ðŸ‡­ +41 (Suisse)</option>
              <option value="+1">ðŸ‡ºðŸ‡¸ +1 (Ã‰tats-Unis)</option>
              <option value="+44">ðŸ‡¬ðŸ‡§ +44 (Royaume-Uni)</option>
              <option value="+49">ðŸ‡©ðŸ‡ª +49 (Allemagne)</option>
              <option value="+34">ðŸ‡ªðŸ‡¸ +34 (Espagne)</option>
              <option value="+39">ðŸ‡®ðŸ‡¹ +39 (Italie)</option>
              <option value="+31">ðŸ‡³ðŸ‡± +31 (Pays-Bas)</option>
              <option value="+351">ðŸ‡µðŸ‡¹ +351 (Portugal)</option>
              <option value="+213">ðŸ‡©ðŸ‡¿ +213 (AlgÃ©rie)</option>
              <option value="+216">ðŸ‡¹ðŸ‡³ +216 (Tunisie)</option>
              <option value="+212">ðŸ‡²ðŸ‡¦ +212 (Maroc)</option>
              <option value="+221">ðŸ‡¸ðŸ‡³ +221 (SÃ©nÃ©gal)</option>
              <option value="+223">ðŸ‡²ðŸ‡± +223 (Mali)</option>
              <option value="+229">ðŸ‡§ðŸ‡¯ +229 (BÃ©nin)</option>
              <option value="+226">ðŸ‡§ðŸ‡« +226 (Burkina Faso)</option>
              <option value="+228">ðŸ‡¹ðŸ‡¬ +228 (Togo)</option>
              <option value="+237">ðŸ‡¨ðŸ‡² +237 (Cameroun)</option>
              <option value="+242">ðŸ‡¨ðŸ‡¬ +242 (Congo)</option>
              <option value="+243">ðŸ‡¨ðŸ‡© +243 (RDC)</option>
              <option value="+233">ðŸ‡¬ðŸ‡­ +233 (Ghana)</option>
              <option value="+234">ðŸ‡³ðŸ‡¬ +234 (Nigeria)</option>
              <option value="+250">ðŸ‡·ðŸ‡¼ +250 (Rwanda)</option>
              <option value="+254">ðŸ‡°ðŸ‡ª +254 (Kenya)</option>
              <option value="+255">ðŸ‡¹ðŸ‡¿ +255 (Tanzanie)</option>
              <option value="+27">ðŸ‡¿ðŸ‡¦ +27 (Afrique du Sud)</option>
              <option value="+90">ðŸ‡¹ðŸ‡· +90 (Turquie)</option>
              <option value="+971">ðŸ‡¦ðŸ‡ª +971 (Ã‰mirats)</option>
              <option value="+966">ðŸ‡¸ðŸ‡¦ +966 (Arabie Saoudite)</option>
              <option value="+20">ðŸ‡ªðŸ‡¬ +20 (Ã‰gypte)</option>
              <option value="+852">ðŸ‡­ðŸ‡° +852 (Hong Kong)</option>
              <option value="+86">ðŸ‡¨ðŸ‡³ +86 (Chine)</option>
              <option value="+81">ðŸ‡¯ðŸ‡µ +81 (Japon)</option>
              <option value="+82">ðŸ‡°ðŸ‡· +82 (CorÃ©e du Sud)</option>
              <option value="+65">ðŸ‡¸ðŸ‡¬ +65 (Singapour)</option>
              <option value="+60">ðŸ‡²ðŸ‡¾ +60 (Malaisie)</option>
              <option value="+61">ðŸ‡¦ðŸ‡º +61 (Australie)</option>
              <option value="+64">ðŸ‡³ðŸ‡¿ +64 (Nouvelle-ZÃ©lande)</option>
              <option value="+55">ðŸ‡§ðŸ‡· +55 (BrÃ©sil)</option>
              <option value="+52">ðŸ‡²ðŸ‡½ +52 (Mexique)</option>
              <option value="+51">ðŸ‡µðŸ‡ª +51 (PÃ©rou)</option>
              <option value="+57">ðŸ‡¨ðŸ‡´ +57 (Colombie)</option>
              <option value="+58">ðŸ‡»ðŸ‡ª +58 (Venezuela)</option>
              <option value="+54">ðŸ‡¦ðŸ‡· +54 (Argentine)</option>
              <option value="+56">ðŸ‡¨ðŸ‡± +56 (Chili)</option>
              <option value="+7">ðŸ‡·ðŸ‡º +7 (Russie)</option>
              <option value="+380">ðŸ‡ºðŸ‡¦ +380 (Ukraine)</option>
              <option value="+48">ðŸ‡µðŸ‡± +48 (Pologne)</option>
              <option value="+40">ðŸ‡·ðŸ‡´ +40 (Roumanie)</option>
              <option value="+30">ðŸ‡¬ðŸ‡· +30 (GrÃ¨ce)</option>
            </select>
            <input id="telephone" required placeholder="NumÃ©ro WhatsApp" style="flex: 1;">
          </div>
        </div>
        
        <div class="group">
          <label>Email *</label>
          <input id="email" type="email" required>
        </div>

        <!-- PHOTO EN TENUE NANAWAX -->
        <div class="group">
          <label>Photo en tenue Nanawax</label>
          <div class="upload-container">
            <input type="file" id="photo" accept="image/jpeg, image/png" style="display: none;">
            <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
              <button type="button" id="uploadBtn">
                <i class="fas fa-cloud-upload-alt" style="margin-right: 8px;"></i> Choisir une photo
              </button>
              <span id="fileName" style="color: #5a4432; font-style: italic;">Aucune photo sÃ©lectionnÃ©e</span>
            </div>
            <div id="imagePreview" style="margin-top: 15px; display: none;">
              <div style="width: 150px; height: 150px; border-radius: 12px; overflow: hidden; border: 2px solid var(--marron);">
                <img id="previewImage" style="width: 100%; height: 100%; object-fit: cover;">
              </div>
              <button type="button" id="removePhoto">
                <i class="fas fa-trash" style="margin-right: 5px;"></i> Supprimer
              </button>
            </div>
            <small style="display: block; margin-top: 8px; color: #7a5c48; opacity: 0.8;">
              Formats acceptÃ©s : JPG, PNG (max. 5MB)
            </small>
          </div>
        </div>
      </div>

      <!-- TAILLE DES VÃŠTEMENTS -->
      <div class="form-section">
        <h3>Taille des vÃªtements</h3>
        <div class="options" id="taille-vetements">
          <div class="option" data-value="XS">XS</div>
          <div class="option" data-value="S">S</div>
          <div class="option" data-value="M">M</div>
          <div class="option" data-value="L">L</div>
          <div class="option" data-value="XL">XL</div>
          <div class="option" data-value="2XL">2XL</div>
          <div class="option" data-value="3XL">3XL</div>
          <div class="option" data-value="4XL">4XL</div>
        </div>
      </div>

      <!-- POINTURES -->
      <div class="form-section">
        <h3>Pointure</h3>
        <div class="options" id="pointures">
          <div class="option" data-value="36">36</div>
          <div class="option" data-value="37">37</div>
          <div class="option" data-value="38">38</div>
          <div class="option" data-value="39">39</div>
          <div class="option" data-value="40">40</div>
          <div class="option" data-value="41">41</div>
          <div class="option" data-value="42">42</div>
          <div class="option" data-value="43">43</div>
          <div class="option" data-value="44">44</div>
          <div class="option" data-value="45">45</div>
          <div class="option" data-value="46">46</div>
        </div>
      </div>

      <!-- COULEURS PRÃ‰FÃ‰RÃ‰ES -->
      <div class="form-section">
        <h3>Couleurs prÃ©fÃ©rÃ©es</h3>
        <div class="options" id="couleurs">
          <div class="option" data-value="blanc">blanc</div>
          <div class="option" data-value="noir">noir</div>
          <div class="option" data-value="marron">marron</div>
          <div class="option" data-value="beige">beige</div>
          <div class="option" data-value="bleu">bleu</div>
          <div class="option" data-value="vert">vert</div>
          <div class="option" data-value="rouge">rouge</div>
          <div class="option" data-value="rose">rose</div>
          <div class="option" data-value="violet">violet</div>
          <div class="option" data-value="jaune">jaune</div>
          <div class="option" data-value="orange">orange</div>
          <div class="option" data-value="saumon">saumon</div>
          <div class="option" data-value="terracotta">terracotta</div>
        </div>
      </div>

      <!-- CONSOMMATION D'ALCOOL -->
      <div class="form-section">
        <h3>Consommation d'alcool</h3>
        <div class="options" id="alcool-option">
          <div class="option" data-value="oui">Oui</div>
          <div class="option" data-value="non">Non</div>
        </div>
      </div>

      <!-- JUS PRÃ‰FÃ‰RÃ‰S -->
      <div class="form-section" id="jus-section">
        <h3>Jus prÃ©fÃ©rÃ©s</h3>
        <div class="options" id="jus">
          <div class="option" data-value="pomme">pomme</div>
          <div class="option" data-value="mangue">mangue</div>
          <div class="option" data-value="ananas">ananas</div>
          <div class="option" data-value="orange">orange</div>
          <div class="option" data-value="aucun">aucun</div>
        </div>
      </div>

      <!-- CHAMPAGNE (UNIQUEMENT SI ALCOOL = OUI) -->
      <div class="form-section alcool-section hidden" id="champagne-section">
        <h3>Champagne prÃ©fÃ©rÃ©</h3>
        <div class="options" id="champagne">
          <div class="option" data-value="rosÃ©">rosÃ©</div>
          <div class="option" data-value="demi sec">demi sec</div>
          <div class="option" data-value="brut">brut</div>
        </div>
      </div>

      <!-- SPIRITUEUX (UNIQUEMENT SI ALCOOL = OUI) -->
      <div class="form-section alcool-section hidden" id="spiritueux-section">
        <h3>Spiritueux prÃ©fÃ©rÃ©s</h3>
        <div class="options" id="spiritueux">
          <div class="option" data-value="vodka">vodka</div>
          <div class="option" data-value="rhum">rhum</div>
          <div class="option" data-value="gin">gin</div>
          <div class="option" data-value="whisky">whisky</div>
        </div>
      </div>

      <!-- BOISSONS CHAUDES -->
      <div class="form-section">
        <h3>Boissons chaudes</h3>
        <div class="options" id="boissons-chaudes">
          <div class="option" data-value="thÃ©">ThÃ©</div>
          <div class="option" data-value="cafÃ©">CafÃ©</div>
        </div>
      </div>

      <!-- ALLERGIES FRUITS DE MER -->
      <div class="form-section">
        <h3>Allergies aux fruits de mer</h3>
        <div class="options" id="allergies">
          <div class="option" data-value="oui">Oui</div>
          <div class="option" data-value="non">Non</div>
        </div>
      </div>

      <button type="submit">Confirmer la rÃ©servation</button>

    </form>
  </section>
</div>

<!-- CONFIRMATION -->
<div class="overlay" id="overlay">
  <div class="confirm">
    <h2>ðŸŽ‰ RÃ©servation confirmÃ©e</h2>
    <div id="resume"></div><br>
    <button onclick="closeConfirm()">Fermer</button>
  </div>
</div>

<script>
// Configuration Cloudinary
const CLOUDINARY_CLOUD_NAME = 'dehjhn0we';
const CLOUDINARY_UPLOAD_PRESET = 'nanawax_photos';

/* ===== EMAILJS ===== */
emailjs.init("13uhnx4ywp64w0KDy");

/* ===== GOUTTELETTES D'EAU ===== */
const dropletsContainer = document.getElementById("droplets");
const DROPLETS_COUNT = 22;

for(let i=0;i<DROPLETS_COUNT;i++){
  const d = document.createElement("div");
  d.className = "droplet";
  dropletsContainer.appendChild(d);

  const size = Math.random() * 24 + 8;

  gsap.set(d,{
    width: size,
    height: size,
    x: Math.random() * window.innerWidth,
    y: Math.random() * window.innerHeight,
    opacity: Math.random() * 0.25 + 0.15
  });

  gsap.to(d,{
    x: "+=" + (Math.random()*20-10),
    y: "+=" + (Math.random()*20-10),
    scale: Math.random()*0.15 + 0.95,
    duration: Math.random()*6 + 6,
    repeat:-1,
    yoyo:true,
    ease:"sine.inOut"
  });
}

/* ===== RAYONS DE SOLEIL ===== */
const sun = document.getElementById("sunRays");
const RAYS_COUNT = 12;

for(let i=0;i<RAYS_COUNT;i++){
  const r = document.createElement("div");
  r.className = "ray";
  sun.appendChild(r);

  gsap.set(r,{ rotation:(360/RAYS_COUNT)*i });
}

gsap.to(".ray",{
  rotation:"+=360",
  duration:90,
  repeat:-1,
  ease:"none"
});

gsap.to(".ray",{
  opacity:()=>Math.random()*0.4+0.3,
  scaleY:()=>Math.random()*0.3+0.9,
  duration:()=>Math.random()*4+3,
  repeat:-1,
  yoyo:true,
  stagger:0.15,
  ease:"sine.inOut"
});

/* ===== LOGIQUE ===== */
const form = document.getElementById("form");
const nom = document.getElementById("nom");
const prenom = document.getElementById("prenom");
const email = document.getElementById("email");
const indicatif = document.getElementById("indicatif");
const telephone = document.getElementById("telephone");
const overlay = document.getElementById("overlay");
const resume = document.getElementById("resume");

// Sections alcool
const champagneSection = document.getElementById("champagne-section");
const spiritueuxSection = document.getElementById("spiritueux-section");

// Variables pour stocker les sÃ©lections
let selectedTaille = [];
let selectedPointure = [];
let selectedCouleurs = [];
let selectedAlcool = "";
let selectedJus = [];
let selectedChampagne = [];
let selectedSpiritueux = [];
let selectedBoissonsChaudes = [];
let selectedAllergies = "";

/* ===== GESTION UPLOAD PHOTO ===== */
const photoInput = document.getElementById('photo');
const uploadBtn = document.getElementById('uploadBtn');
const fileName = document.getElementById('fileName');
const imagePreview = document.getElementById('imagePreview');
const previewImage = document.getElementById('previewImage');
const removePhotoBtn = document.getElementById('removePhoto');

let uploadedPhoto = null;
let cloudinaryPhotoUrl = null;

// Ouvrir le sÃ©lecteur de fichier au clic
uploadBtn.onclick = () => {
  photoInput.click();
};

// GÃ©rer la sÃ©lection de fichier
photoInput.onchange = (e) => {
  const file = e.target.files[0];
  if (file) {
    // VÃ©rifier la taille (max 5MB)
    if (file.size > 5 * 1024 * 1024) {
      alert('La photo est trop volumineuse. Taille maximale : 5MB');
      photoInput.value = '';
      return;
    }
    
    // VÃ©rifier le type
    if (!file.type.match('image/jpeg') && !file.type.match('image/png')) {
      alert('Format non supportÃ©. Utilisez JPG ou PNG.');
      photoInput.value = '';
      return;
    }
    
    uploadedPhoto = file;
    fileName.textContent = `${file.name} (${(file.size / 1024 / 1024).toFixed(2)} MB)`;
    
    // Afficher la prÃ©visualisation
    const reader = new FileReader();
    reader.onload = (event) => {
      previewImage.src = event.target.result;
      imagePreview.style.display = 'block';
    };
    reader.readAsDataURL(file);
  }
};

// Supprimer la photo
removePhotoBtn.onclick = () => {
  photoInput.value = '';
  uploadedPhoto = null;
  cloudinaryPhotoUrl = null;
  fileName.textContent = 'Aucune photo sÃ©lectionnÃ©e';
  imagePreview.style.display = 'none';
  previewImage.src = '';
};

/* ===== FONCTION D'UPLOAD CLOUDINARY ===== */
async function uploadToCloudinary(file) {
  // Afficher un indicateur de chargement
  const originalText = uploadBtn.innerHTML;
  uploadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Upload en cours...';
  uploadBtn.disabled = true;
  
  try {
    const formData = new FormData();
    formData.append('file', file);
    formData.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
    formData.append('folder', 'nanawax_photos');
    formData.append('tags', 'nanawax,invite,photo');
    
    // Upload vers Cloudinary
    const response = await fetch(
      `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/image/upload`,
      {
        method: 'POST',
        body: formData
      }
    );
    
    if (!response.ok) {
      throw new Error(`Erreur Cloudinary: ${response.status}`);
    }
    
    const data = await response.json();
    
    // Retourner l'URL optimisÃ©e
    return {
      url: data.secure_url,
      public_id: data.public_id,
      format: data.format,
      size: data.bytes
    };
    
  } catch (error) {
    console.error('Erreur upload Cloudinary:', error);
    alert('Erreur lors de l\'upload de la photo. Veuillez rÃ©essayer.');
    return null;
  } finally {
    // Restaurer le bouton
    uploadBtn.innerHTML = originalText;
    uploadBtn.disabled = false;
  }
}

/* ===== PARTICULES ===== */
const particlesContainer = document.getElementById("particles");
const PARTICLES_COUNT = 18;

for(let i=0;i<PARTICLES_COUNT;i++){
  const p = document.createElement("div");
  p.className = "particle";
  particlesContainer.appendChild(p);

  gsap.set(p,{
    x: Math.random() * window.innerWidth,
    y: Math.random() * window.innerHeight,
    scale: Math.random() * 1.2 + 0.4
  });

  gsap.to(p,{
    y: "-=120",
    x: "+=40",
    opacity: 1,
    duration: Math.random() * 10 + 12,
    repeat: -1,
    yoyo: true,
    ease: "sine.inOut",
    delay: Math.random() * 5
  });
}

/* ===== GESTION DES OPTIONS ===== */
function setupOptions(containerId, selectedArray, isSingle = false) {
  const container = document.getElementById(containerId);
  const options = container.querySelectorAll(".option");
  
  options.forEach(option => {
    option.onclick = () => {
      if (isSingle) {
        // Pour une sÃ©lection unique
        options.forEach(o => o.classList.remove("active"));
        option.classList.add("active");
        selectedArray.length = 0;
        selectedArray.push(option.dataset.value);
      } else {
        // Pour sÃ©lection multiple
        option.classList.toggle("active");
        const value = option.dataset.value;
        if (selectedArray.includes(value)) {
          selectedArray = selectedArray.filter(x => x !== value);
        } else {
          selectedArray.push(value);
        }
      }
    };
  });
  
  return { options, selectedArray };
}

// Initialiser toutes les options
const tailleVetements = setupOptions("taille-vetements", selectedTaille, true);
selectedTaille = tailleVetements.selectedArray;

const pointures = setupOptions("pointures", selectedPointure, true);
selectedPointure = pointures.selectedArray;

const couleurs = setupOptions("couleurs", selectedCouleurs);
selectedCouleurs = couleurs.selectedArray;

const alcoolOption = setupOptions("alcool-option", [selectedAlcool], true);
// Surveiller les changements pour l'alcool
document.querySelectorAll('#alcool-option .option').forEach(option => {
  option.onclick = function() {
    document.querySelectorAll('#alcool-option .option').forEach(o => o.classList.remove("active"));
    this.classList.add("active");
    selectedAlcool = this.dataset.value;
    
    // Afficher/masquer les sections alcool
    if (selectedAlcool === "oui") {
      champagneSection.classList.remove("hidden");
      spiritueuxSection.classList.remove("hidden");
    } else {
      champagneSection.classList.add("hidden");
      spiritueuxSection.classList.add("hidden");
      // RÃ©initialiser les sÃ©lections d'alcool
      selectedChampagne = [];
      selectedSpiritueux = [];
      document.querySelectorAll('#champagne .option, #spiritueux .option').forEach(o => {
        o.classList.remove("active");
      });
    }
  };
});

const jus = setupOptions("jus", selectedJus);
selectedJus = jus.selectedArray;

const champagne = setupOptions("champagne", selectedChampagne);
selectedChampagne = champagne.selectedArray;

const spiritueux = setupOptions("spiritueux", selectedSpiritueux);
selectedSpiritueux = spiritueux.selectedArray;

const boissonsChaudes = setupOptions("boissons-chaudes", selectedBoissonsChaudes);
selectedBoissonsChaudes = boissonsChaudes.selectedArray;

const allergies = setupOptions("allergies", [selectedAllergies], true);
// Mettre Ã  jour selectedAllergies
document.querySelectorAll('#allergies .option').forEach(option => {
  option.onclick = function() {
    document.querySelectorAll('#allergies .option').forEach(o => o.classList.remove("active"));
    this.classList.add("active");
    selectedAllergies = this.dataset.value;
  };
});

/* ===== SOUMISSION DU FORMULAIRE ===== */
form.onsubmit = async e => {
  e.preventDefault();
  
  // DÃ©sactiver le bouton pendant l'envoi
  const submitBtn = document.querySelector('button[type="submit"]');
  const originalBtnText = submitBtn.innerHTML;
  submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Envoi en cours...';
  submitBtn.disabled = true;
  
  try {
    let photoData = null;
    
    // 1. Upload de la photo sur Cloudinary si elle existe
    if (uploadedPhoto) {
      photoData = await uploadToCloudinary(uploadedPhoto);
      
      if (!photoData) {
        const continueWithoutPhoto = confirm('ProblÃ¨me avec l\'upload photo. Continuer sans la photo ?');
        if (!continueWithoutPhoto) {
          submitBtn.innerHTML = originalBtnText;
          submitBtn.disabled = false;
          return;
        }
      }
    }
    
    // RÃ©cupÃ©rer toutes les sÃ©lections actuelles
    selectedTaille = [];
    selectedPointure = [];
    selectedCouleurs = [];
    selectedJus = [];
    selectedChampagne = [];
    selectedSpiritueux = [];
    selectedBoissonsChaudes = [];
    
    document.querySelectorAll('#taille-vetements .option.active').forEach(o => {
      selectedTaille.push(o.dataset.value);
    });
    
    document.querySelectorAll('#pointures .option.active').forEach(o => {
      selectedPointure.push(o.dataset.value);
    });
    
    document.querySelectorAll('#couleurs .option.active').forEach(o => {
      selectedCouleurs.push(o.dataset.value);
    });
    
    document.querySelectorAll('#jus .option.active').forEach(o => {
      selectedJus.push(o.dataset.value);
    });
    
    document.querySelectorAll('#champagne .option.active').forEach(o => {
      selectedChampagne.push(o.dataset.value);
    });
    
    document.querySelectorAll('#spiritueux .option.active').forEach(o => {
      selectedSpiritueux.push(o.dataset.value);
    });
    
    document.querySelectorAll('#boissons-chaudes .option.active').forEach(o => {
      selectedBoissonsChaudes.push(o.dataset.value);
    });

    // 2. PrÃ©parer les donnÃ©es pour EmailJS
    const data = {
      nom: nom.value,
      prenom: prenom.value,
      email: email.value,
      indicatif: indicatif.value,
      telephone: telephone.value,
      telephone_complet: indicatif.value + " " + telephone.value,
      taille: selectedTaille.join(", ") || "â€”",
      pointure: selectedPointure.join(", ") || "â€”",
      couleurs: selectedCouleurs.join(", ") || "â€”",
      alcool: selectedAlcool || "â€”",
      jus: selectedJus.join(", ") || "â€”",
      champagne: selectedChampagne.join(", ") || "â€”",
      spiritueux: selectedSpiritueux.join(", ") || "â€”",
      boissons_chaudes: selectedBoissonsChaudes.join(", ") || "â€”",
      allergies_fruits_de_mer: selectedAllergies || "â€”",
      evenement: "Finale Nanawax XV",
      date: "28-30 mars 2026",
      lieu: "Assinie",
      photo_uploaded: photoData ? "OUI" : "NON",
      photo_url: photoData ? photoData.url : "Aucune photo",
      photo_size: photoData ? `${(photoData.size / 1024).toFixed(1)} KB` : "â€”",
      submission_date: new Date().toLocaleString('fr-FR')
    };
    
    // 3. Envoyer via EmailJS
    await emailjs.send("service_xoza1k6", "template_jtmxw1q", data);
    
    // 4. Afficher confirmation
    resume.innerHTML = `
      <div style="text-align: left; line-height: 1.6;">
        <h3 style="color: #7a5c48; margin-bottom: 20px;">âœ… RÃ©servation confirmÃ©e !</h3>
        <p><b>Nom :</b> ${data.nom} ${data.prenom}</p>
        <p><b>Email :</b> ${data.email}</p>
        <p><b>TÃ©lÃ©phone :</b> ${data.telephone_complet}</p>
        <p><b>Photo :</b> ${data.photo_uploaded}</p>
        ${photoData ? `
          <p><b>Lien photo :</b></p>
          <div style="margin: 10px 0;">
            <a href="${photoData.url}" target="_blank" 
               style="color: #7a5c48; text-decoration: underline;">
               <i class="fas fa-external-link-alt"></i> Voir la photo sur Cloudinary
            </a>
          </div>
          <small style="color: #666; font-size: 0.9em;">
            Photo sauvegardÃ©e dans votre compte Cloudinary
          </small>
        ` : ''}
        <hr style="margin: 20px 0; border-color: #eee;">
        <p style="color: #28a745; font-weight: 500;">
          <i class="fas fa-envelope"></i> Un rÃ©capitulatif vous a Ã©tÃ© envoyÃ© par email.
        </p>
      </div>
    `;
    
    overlay.classList.add("show");
    
  } catch (error) {
    console.error('Erreur complÃ¨te:', error);
    alert('Une erreur est survenue. Veuillez rÃ©essayer ou nous contacter.');
  } finally {
    // RÃ©activer le bouton
    submitBtn.innerHTML = originalBtnText;
    submitBtn.disabled = false;
  }
};

function closeConfirm() {
  overlay.classList.remove("show");
  form.reset();
  
  // RÃ©initialiser toutes les sÃ©lections
  selectedTaille = [];
  selectedPointure = [];
  selectedCouleurs = [];
  selectedAlcool = "";
  selectedJus = [];
  selectedChampagne = [];
  selectedSpiritueux = [];
  selectedBoissonsChaudes = [];
  selectedAllergies = "";
  uploadedPhoto = null;
  cloudinaryPhotoUrl = null;
  
  // DÃ©sactiver toutes les options
  document.querySelectorAll('.option').forEach(o => {
    o.classList.remove("active");
  });
  
  // RÃ©initialiser la photo
  photoInput.value = '';
  fileName.textContent = 'Aucune photo sÃ©lectionnÃ©e';
  imagePreview.style.display = 'none';
  previewImage.src = '';
  
  // Masquer les sections alcool
  champagneSection.classList.add("hidden");
  spiritueuxSection.classList.add("hidden");
}

/* ===== ANIMATIONS GSAP ===== */
gsap.from(".hero", { opacity: 0, y: -50, duration: 1 });
gsap.from(".glass", { opacity: 0, y: 80, duration: 1, delay: .3 });
</script>

</body>
</html>